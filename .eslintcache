[{"D:\\Akshay\\myReactApps\\shopin-mart\\src\\index.js":"1","D:\\Akshay\\myReactApps\\shopin-mart\\src\\Home.js":"2","D:\\Akshay\\myReactApps\\shopin-mart\\src\\Login.js":"3","D:\\Akshay\\myReactApps\\shopin-mart\\src\\OrdersCombined.js":"4","D:\\Akshay\\myReactApps\\shopin-mart\\src\\PaymentCombined.js":"5","D:\\Akshay\\myReactApps\\shopin-mart\\src\\CheckoutCombined.js":"6","D:\\Akshay\\myReactApps\\shopin-mart\\src\\Checkout.js":"7","D:\\Akshay\\myReactApps\\shopin-mart\\src\\Subtotal.js":"8","D:\\Akshay\\myReactApps\\shopin-mart\\src\\firebase.js":"9","D:\\Akshay\\myReactApps\\shopin-mart\\src\\Payment.js":"10","D:\\Akshay\\myReactApps\\shopin-mart\\src\\Orders.js":"11","D:\\Akshay\\myReactApps\\shopin-mart\\src\\reducer.js":"12","D:\\Akshay\\myReactApps\\shopin-mart\\src\\GuardedRoute.js":"13","D:\\Akshay\\myReactApps\\shopin-mart\\src\\App.js":"14"},{"size":686,"mtime":1611088774358,"results":"15","hashOfConfig":"16"},{"size":2893,"mtime":1618835474760,"results":"17","hashOfConfig":"16"},{"size":2044,"mtime":1618856499734,"results":"18","hashOfConfig":"16"},{"size":254,"mtime":1611351516781,"results":"19","hashOfConfig":"16"},{"size":544,"mtime":1611343746816,"results":"20","hashOfConfig":"16"},{"size":264,"mtime":1611239035871,"results":"21","hashOfConfig":"16"},{"size":1156,"mtime":1618835046555,"results":"22","hashOfConfig":"16"},{"size":1040,"mtime":1611323348814,"results":"23","hashOfConfig":"16"},{"size":1141,"mtime":1618839827672,"results":"24","hashOfConfig":"16"},{"size":5015,"mtime":1618861968302,"results":"25","hashOfConfig":"16"},{"size":1039,"mtime":1618860130346,"results":"26","hashOfConfig":"16"},{"size":1147,"mtime":1618864751923,"results":"27","hashOfConfig":"16"},{"size":336,"mtime":1611239885254,"results":"28","hashOfConfig":"16"},{"size":1891,"mtime":1618911310274,"results":"29","hashOfConfig":"16"},{"filePath":"30","messages":"31","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},"1ls3f0h",{"filePath":"33","messages":"34","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"35","messages":"36","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"37","messages":"38","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"39","messages":"40","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"41","messages":"42","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"43","messages":"44","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"45","messages":"46","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"47","messages":"48","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"49","messages":"50","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"51"},{"filePath":"52","messages":"53","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"54","messages":"55","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"56"},{"filePath":"57","messages":"58","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"59","messages":"60","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"D:\\Akshay\\myReactApps\\shopin-mart\\src\\index.js",[],["61","62"],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\Home.js",[],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\Login.js",[],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\OrdersCombined.js",[],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\PaymentCombined.js",[],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\CheckoutCombined.js",[],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\Checkout.js",["63"],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\Subtotal.js",["64"],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\firebase.js",[],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\Payment.js",["65"],"import React, { useEffect, useState } from \"react\";\r\nimport CheckoutProduct from \"./CheckoutProduct\";\r\nimport \"./Payment.css\";\r\nimport { useStateValue } from \"./StateProvider\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { CardElement, useElements, useStripe } from \"@stripe/react-stripe-js\";\r\nimport CurrencyFormat from \"react-currency-format\";\r\nimport { getBasketTotal } from \"./reducer\";\r\nimport axios from \"./axios\";\r\nimport { db } from \"./firebase\";\r\nfunction Payment() {\r\n  const [{ basket, user }, dispatch] = useStateValue();\r\n  const [error, setError] = useState(null);\r\n  const [disabled, setDisabled] = useState(true);\r\n\r\n  const history = useHistory();\r\n\r\n  const [succeeded, setSucceeded] = useState(false);\r\n  const [processing, setProcessing] = useState(\"\");\r\n  const [clientSecret, setClientSecret] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // generally the special stripe secret which allows us to change a\r\n    //customer\r\n    const getClientSecret = async () => {\r\n      const response = await axios({\r\n        method: \"post\",\r\n        //Stripe expects the total in a currencies subunits\r\n        url: `/payments/create?total=${getBasketTotal(basket) * 100}`,\r\n      });\r\n      setClientSecret(response.data.clientSecret);\r\n    };\r\n    //whenever basket changes we get a new client secret from this function\r\n    getClientSecret();\r\n  }, [basket]);\r\n\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n\r\n  //console.log('THE SECRET CLIENT ID IS>>>',clientSecret);\r\n\r\n  const handleSubmit = async (event) => {\r\n    //all stripe function\r\n\r\n    event.preventDefault();\r\n    setProcessing(true);\r\n\r\n    const payload = await stripe\r\n      .confirmCardPayment(clientSecret, {\r\n        payment_method: {\r\n          card: elements.getElement(CardElement),\r\n        },\r\n      })\r\n      .then(({ paymentIntent }) => {\r\n        //paymentIntent=payment confirmation\r\n        //console.log(\"paymentintent>>\"+paymentIntent.amount);\r\n        //using db\r\n        db.collection('users')\r\n        .doc(user?.uid) \r\n        .collection('orders')\r\n        .doc(paymentIntent?.id)\r\n        .set({\r\n          basket:basket,\r\n          amount:paymentIntent.amount,\r\n          created:paymentIntent.created,\r\n        })\r\n        \r\n        setSucceeded(true);\r\n        setError(null);\r\n        setProcessing(false);\r\n        dispatch({\r\n          type: \"EMPTY_BASKET\",\r\n        });\r\n        history.replace(\"/orders\");\r\n      }).catch(err=>{\r\n        console.log(\"error:\"+err);\r\n      })\r\n  };\r\n  const handleChange = (event) => {\r\n    //listen for changes\r\n    //and display the errors to the customer when they type\r\n    //their details\r\n    setDisabled(event.empty);\r\n    setError(event.error ? event.error.message : \"\");\r\n  };\r\n  return (\r\n    <div className=\"payment\">\r\n      <div className=\"payment__container\">\r\n        <h1>\r\n          Checkout ({<Link to=\"./checkout\">{basket?.length} items</Link>})\r\n        </h1>\r\n        {/* delivery address */}\r\n        <div className=\"payment__section\">\r\n          <div className=\"payment__title\">\r\n            <h3>Delivery Address</h3>\r\n          </div>\r\n          <div className=\"payment__address\">\r\n            <p>{user?.email}</p>\r\n            <p>123 React Lane</p>\r\n            <p>Lorem Ipsum's Mansion , Bhopal</p>\r\n          </div>\r\n        </div>\r\n        {/*  review items*/}\r\n        <div className=\"payment__section\">\r\n          <div className=\"payment__title\">\r\n            <h3>Review items and delivery</h3>\r\n          </div>\r\n          <div className=\"payment__items\">\r\n            {basket.map((item) => (\r\n              <CheckoutProduct\r\n                id={item.id}\r\n                title={item.title}\r\n                image={item.image}\r\n                price={item.price}\r\n                rating={item.rating}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n        {/* payment method */}\r\n        <div className=\"payment__section\">\r\n          <div className=\"payment__title\">\r\n            <h3>Payment Method</h3>\r\n          </div>\r\n          <div className=\"payment__details\">\r\n            {/* Stripe functionaity */}\r\n            <form onClick={handleSubmit}>\r\n              <CardElement onChange={handleChange} />\r\n              <div className=\"payment__priceContainer\">\r\n                <CurrencyFormat\r\n                  renderText={(value) => <h3>Order Total:{value}</h3>}\r\n                  decimalScale={2}\r\n                  value={getBasketTotal(basket)}\r\n                  displayType={\"text\"}\r\n                  thousandSeparator={true}\r\n                  prefix={\"â‚¹\"}\r\n                />\r\n                <button disabled={processing || disabled || succeeded}>\r\n                  <span>{processing ? <p>Processing</p> : \"Buy Now\"}</span>\r\n                </button>\r\n              </div>\r\n              {/* Error */}\r\n              {error && <div>{error}</div>}\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Payment;\r\n","D:\\Akshay\\myReactApps\\shopin-mart\\src\\Orders.js",["66","67","68"],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\reducer.js",[],["69","70"],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\GuardedRoute.js",[],"D:\\Akshay\\myReactApps\\shopin-mart\\src\\App.js",["71","72"],{"ruleId":"73","replacedBy":"74"},{"ruleId":"75","replacedBy":"76"},{"ruleId":"77","severity":1,"message":"78","line":7,"column":28,"nodeType":"79","messageId":"80","endLine":7,"endColumn":36},{"ruleId":"77","severity":1,"message":"78","line":8,"column":22,"nodeType":"79","messageId":"80","endLine":8,"endColumn":30},{"ruleId":"77","severity":1,"message":"81","line":48,"column":11,"nodeType":"79","messageId":"80","endLine":48,"endColumn":18},{"ruleId":"77","severity":1,"message":"82","line":9,"column":12,"nodeType":"79","messageId":"80","endLine":9,"endColumn":18},{"ruleId":"77","severity":1,"message":"78","line":9,"column":28,"nodeType":"79","messageId":"80","endLine":9,"endColumn":36},{"ruleId":"83","severity":1,"message":"84","line":29,"column":6,"nodeType":"85","endLine":29,"endColumn":8,"suggestions":"86"},{"ruleId":"73","replacedBy":"87"},{"ruleId":"75","replacedBy":"88"},{"ruleId":"77","severity":1,"message":"82","line":17,"column":12,"nodeType":"79","messageId":"80","endLine":17,"endColumn":18},{"ruleId":"83","severity":1,"message":"89","line":37,"column":6,"nodeType":"85","endLine":37,"endColumn":8,"suggestions":"90"},"no-native-reassign",["91"],"no-negated-in-lhs",["92"],"no-unused-vars","'dispatch' is assigned a value but never used.","Identifier","unusedVar","'payload' is assigned a value but never used.","'basket' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'user'. Either include it or remove the dependency array.","ArrayExpression",["93"],["91"],["92"],"React Hook useEffect has a missing dependency: 'dispatch'. Either include it or remove the dependency array.",["94"],"no-global-assign","no-unsafe-negation",{"desc":"95","fix":"96"},{"desc":"97","fix":"98"},"Update the dependencies array to be: [user]",{"range":"99","text":"100"},"Update the dependencies array to be: [dispatch]",{"range":"101","text":"102"},[775,777],"[user]",[1078,1080],"[dispatch]"]